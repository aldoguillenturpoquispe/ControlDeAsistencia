<section class="admin-asistencias">
  <!-- Loader -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando asistencias...</p>
  </div>

  <!-- Contenido principal -->
  <div *ngIf="!isLoading">
    <!-- Mostrar tipo de usuario -->
    <div class="user-info" *ngIf="esAdmin">
      <span class="badge-admin">ğŸ‘‘ Modo Administrador</span>
    </div>

    <h2>Panel de Asistencias</h2>

    <!-- Barra de acciones -->
    <div class="toolbar">
      <button class="btn primary" (click)="abrirModal()">â• Nueva Asistencia</button>
    </div>

    <!-- Filtros -->
    <div class="filters">
      <label>
        Fecha:
        <input type="date" [(ngModel)]="filtroFecha">
      </label>
      <label>
        Usuario:
        <input type="text" placeholder="Buscar usuario..." [(ngModel)]="filtroUsuario">
      </label>
      <label>
        Estado:
        <select [(ngModel)]="filtroEstado">
          <option value="">Todos</option>
          <option value="presente">Presente</option>
          <option value="ausente">Ausente</option>
          <option value="tardanza">Tardanza</option>
          <option value="permiso">Permiso</option>
        </select>
      </label>
      <button class="btn filter" (click)="aplicarFiltros()">ğŸ” Filtrar</button>
      <button class="btn secondary" (click)="limpiarFiltros()">ğŸ”„ Limpiar</button>
    </div>

    <!-- EstadÃ­sticas / Resumen -->
    <div class="stats-container">
      <div class="stat-card">
        <h3>Total Registros</h3>
        <p class="stat-number">{{ totalRegistros }}</p>
      </div>
      <div class="stat-card">
        <h3>Presentes Hoy</h3>
        <p class="stat-number">{{ presentesHoy }}</p>
      </div>
      <div class="stat-card">
        <h3>Ausentes Hoy</h3>
        <p class="stat-number">{{ ausentesHoy }}</p>
      </div>
      <div class="stat-card">
        <h3>Tardanzas</h3>
        <p class="stat-number">{{ tardanzasHoy }}</p>
      </div>
    </div>

    <!-- Mensaje si no hay datos -->
    <div *ngIf="asistenciasFiltradas.length === 0" class="no-data">
      <i class="fas fa-inbox"></i>
      <p>No hay asistencias registradas</p>
      <button class="btn primary" (click)="abrirModal()">Registrar primera asistencia</button>
    </div>

    <!-- Tabla de asistencias -->
    <app-asistencia-tabla
      *ngIf="asistenciasFiltradas.length > 0"
      [asistencias]="asistenciasPaginadas"
      [paginaActual]="paginaActual"
      [itemsPorPagina]="itemsPorPagina"
      [esAdmin]="esAdmin"
      (eliminar)="eliminarAsistencia($event)"
      (editar)="abrirModalEditar($event)">
    </app-asistencia-tabla>

    <!-- PaginaciÃ³n -->
    <div class="pagination" *ngIf="asistenciasFiltradas.length > 0">
      <button class="btn secondary" (click)="paginaAnterior()" [disabled]="paginaActual === 1">
        Â« Anterior
      </button>
      <span class="page-info">PÃ¡gina {{ paginaActual }} de {{ totalPaginas }}</span>
      <button class="bt<<an secondary" (click)="paginaSiguiente()" [disabled]="paginaActual === totalPaginas">
        Siguiente Â»
      </button>
    </div>
  </div>

  <!-- ğŸ”¥ MODIFICADO: Modal formulario con asistencia para editar -->
  <app-asistencia-form-modal
    *ngIf="mostrarModal"
    [asistenciaParaEditar]="asistenciaParaEditar"
    (cerrar)="cerrarModal($event)">
  </app-asistencia-form-modal>

  <!-- Modal de confirmaciÃ³n de eliminaciÃ³n -->
  <app-asistencia-delete-modal
    *ngIf="mostrarModalEliminar && asistenciaParaEliminar"
    [asistencia]="asistenciaParaEliminar"
    (confirmar)="confirmarEliminacion()"
    (cancelar)="cancelarEliminacion()">
  </app-asistencia-delete-modal>
</section>

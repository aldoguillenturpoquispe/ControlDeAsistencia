<section class="admin-stats">
  <!-- Loader -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando estadÃ­sticas...</p>
  </div>

  <!-- Contenido -->
  <div *ngIf="!isLoading">
    <h2>Panel de EstadÃ­sticas</h2>

    <!-- Filtros de fecha -->
    <div class="filters-stats">
      <label>
        PerÃ­odo:
        <select [(ngModel)]="periodo" (change)="actualizarEstadisticas()">
          <option value="hoy">Hoy</option>
          <option value="semana">Esta Semana</option>
          <option value="mes">Este Mes</option>
          <option value="anio">Este AÃ±o</option>
        </select>
      </label>
      <label>
        Desde:
        <input type="date" [(ngModel)]="fechaDesde">
      </label>
      <label>
        Hasta:
        <input type="date" [(ngModel)]="fechaHasta">
      </label>
      <button class="btn-filter" (click)="actualizarEstadisticas()">ğŸ” Actualizar</button>
    </div>

    <!-- Resumen en tarjetas principales -->
    <div class="cards">
      <div class="card">
        <div class="card-icon">ğŸ‘¥</div>
        <h3>Total Usuarios</h3>
        <p class="value">{{ datosEstadisticas.totalUsuarios }}</p>
        <span class="card-subtitle">Registrados activos</span>
      </div>
      <div class="card">
        <div class="card-icon">âœ…</div>
        <h3>Asistencias Hoy</h3>
        <p class="value success">{{ datosEstadisticas.asistenciasHoy }}</p>
        <span class="card-subtitle">Presentes</span>
      </div>
      <div class="card">
        <div class="card-icon">âŒ</div>
        <h3>Faltas Hoy</h3>
        <p class="value danger">{{ datosEstadisticas.faltasHoy }}</p>
        <span class="card-subtitle">Ausentes</span>
      </div>
      <div class="card">
        <div class="card-icon">ğŸ“Š</div>
        <h3>Porcentaje Asistencia</h3>
        <p class="value warning">{{ datosEstadisticas.porcentajeAsistencia }}%</p>
        <span class="card-subtitle">Del perÃ­odo seleccionado</span>
      </div>
    </div>

    <!-- Tarjetas adicionales de resumen -->
    <div class="cards-secondary">
      <div class="card-small">
        <h4>Tardanzas del PerÃ­odo</h4>
        <p class="value-small">{{ datosEstadisticas.tardanzasMes }}</p>
      </div>
      <div class="card-small">
        <h4>Promedio Horas/DÃ­a</h4>
        <p class="value-small">{{ datosEstadisticas.promedioHoras }}h</p>
      </div>
      <div class="card-small">
        <h4>DÃ­as Laborables</h4>
        <p class="value-small">{{ datosEstadisticas.diasLaborables }}</p>
      </div>
      <div class="card-small">
        <h4>Mejor Asistencia</h4>
        <p class="value-small">{{ datosEstadisticas.mejorAsistencia }}%</p>
      </div>
    </div>

    <!-- GrÃ¡ficos (COMPONENTE SEPARADO con inputs) -->
    <app-stats-charts 
      [fechaDesde]="fechaDesde" 
      [fechaHasta]="fechaHasta">
    </app-stats-charts>
    
    <!-- Tabla de top usuarios (COMPONENTE SEPARADO con inputs) -->
    <app-stats-top-usuarios 
      [fechaDesde]="fechaDesde" 
      [fechaHasta]="fechaHasta">
    </app-stats-top-usuarios>

    <!-- Resumen por estado (COMPONENTE SEPARADO con inputs) -->
    <app-stats-resumen-estados 
      [fechaDesde]="fechaDesde" 
      [fechaHasta]="fechaHasta">
    </app-stats-resumen-estados>

    <!-- Botones de exportaciÃ³n -->
    <div class="export-actions">
      <button class="btn-export" (click)="exportarPDF()">ğŸ“¥ Exportar EstadÃ­sticas PDF</button>
      <button class="btn-export" (click)="exportarExcel()">ğŸ“Š Exportar Excel</button>
      <button class="btn-export" (click)="enviarReporte()">ğŸ“§ Enviar Reporte</button>
    </div>
  </div>
</section>